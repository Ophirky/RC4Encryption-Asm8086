di,cx, si, bx=0
FOR (DI <= 255) {
    // choosing the psuedo random location in the sched array \\
    bl += [sched Offset +di]
    si = di
    div si, len(key)
    si = resedue of division

    bl += [keyOffset + si]
    div bl, 256
    bl = resedue of division

    // Switching between two items in the sched array[bx,di] \\
    si = schedOffset
    si += di

    ax = [schedOffset + bl]
    [si] = ax

    ax = schedOffset
    ax += bx
    si = [si]
    [ax] = si
}